<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1181px" preserveAspectRatio="none" style="width:1522px;height:1181px;" version="1.1" viewBox="0 0 1522 1181" width="1522px" zoomAndPan="magnify"><defs><filter height="300%" id="f6pdo735rv1w7" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--cluster auth.Domain--><rect fill="#FFFFFF" filter="url(#f6pdo735rv1w7)" height="1022" style="stroke: #000000; stroke-width: 1.5;" width="1128" x="382" y="24"/><line style="stroke: #000000; stroke-width: 1.5;" x1="382" x2="1510" y1="44.4883" y2="44.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="56" x="918" y="39.5352">Domain</text><!--cluster auth.Domain.CQ--><rect fill="#FFFFFF" filter="url(#f6pdo735rv1w7)" height="396" style="stroke: #000000; stroke-width: 1.5;" width="723" x="434" y="204"/><line style="stroke: #000000; stroke-width: 1.5;" x1="434" x2="1157" y1="224.4883" y2="224.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="152" x="719.5" y="219.5352">Command and Query</text><!--cluster auth.Domain.CQ.api.email--><polygon fill="#FFFFFF" filter="url(#f6pdo735rv1w7)" points="458,247,529,247,536,269.4883,1133,269.4883,1133,576,458,576,458,247" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="458" x2="536" y1="269.4883" y2="269.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="65" x="462" y="262.5352">api.email</text><!--cluster auth.Domain.CQ.api.email.command--><polygon fill="#FFFFFF" filter="url(#f6pdo735rv1w7)" points="941.5,439,1017.5,439,1024.5,461.4883,1107.5,461.4883,1107.5,552,941.5,552,941.5,439" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="941.5" x2="1024.5" y1="461.4883" y2="461.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="70" x="945.5" y="454.5352">command</text><!--cluster auth.Domain.CQ.api.email.query--><polygon fill="#FFFFFF" filter="url(#f6pdo735rv1w7)" points="940,290,986,290,993,312.4883,1109,312.4883,1109,415,940,415,940,290" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="940" x2="993" y1="312.4883" y2="312.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="40" x="944" y="305.5352">query</text><!--cluster auth.Domain.Repository--><rect fill="#FFFFFF" filter="url(#f6pdo735rv1w7)" height="113" style="stroke: #000000; stroke-width: 1.5;" width="505" x="772" y="67"/><line style="stroke: #000000; stroke-width: 1.5;" x1="772" x2="1277" y1="87.4883" y2="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="78" x="985.5" y="82.5352">Repository</text><!--cluster auth.Domain.models--><rect fill="#FFFFFF" filter="url(#f6pdo735rv1w7)" height="398" style="stroke: #000000; stroke-width: 1.5;" width="1080" x="406" y="624"/><line style="stroke: #000000; stroke-width: 1.5;" x1="406" x2="1486" y1="644.4883" y2="644.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="52" x="920" y="639.5352">Models</text><!--cluster auth.Domain.models.values--><rect fill="#FFFFFF" filter="url(#f6pdo735rv1w7)" height="249" style="stroke: #000000; stroke-width: 1.5;" width="667.5" x="430" y="667"/><line style="stroke: #000000; stroke-width: 1.5;" x1="430" x2="1097.5" y1="687.4883" y2="687.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="46" x="740.75" y="682.5352">values</text><!--cluster auth.domain.values.email--><polygon fill="#FFFFFF" filter="url(#f6pdo735rv1w7)" points="454,710,641,710,648,732.4883,651,732.4883,651,892,454,892,454,710" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="454" x2="648" y1="732.4883" y2="732.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="181" x="458" y="725.5352">auth.domain.values.email</text><!--cluster auth.UseCase--><rect fill="#FFFFFF" filter="url(#f6pdo735rv1w7)" height="259" style="stroke: #000000; stroke-width: 1.5;" width="336" x="22" y="204"/><line style="stroke: #000000; stroke-width: 1.5;" x1="22" x2="358" y1="224.4883" y2="224.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="160" y="219.5352">UseCase</text><!--cluster auth.UseCase.vchat.app--><polygon fill="#FFFFFF" filter="url(#f6pdo735rv1w7)" points="46,247,119,247,126,269.4883,334,269.4883,334,439,46,439,46,247" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="46" x2="126" y1="269.4883" y2="269.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="67" x="50" y="262.5352">vchat.app</text><!--cluster auth.UseCase.vchat.app.email--><polygon fill="#FFFFFF" filter="url(#f6pdo735rv1w7)" points="70,290,204,290,211,312.4883,310,312.4883,310,415,70,415,70,290" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="70" x2="211" y1="312.4883" y2="312.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="128" x="74" y="305.5352">service.auth.email</text><!--cluster state.Domain.models.values--><polygon fill="#FFFFFF" filter="url(#f6pdo735rv1w7)" points="444,1070,650,1070,657,1092.4883,660,1092.4883,660,1169,444,1169,444,1070" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="444" x2="657" y1="1092.4883" y2="1092.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="200" x="448" y="1085.5352">state.Domain.models.values</text><!--class auth.Domain.CQ.api.email.EmailAuthorizer--><rect fill="#FEFECE" filter="url(#f6pdo735rv1w7)" height="99.8203" id="auth.Domain.CQ.api.email.EmailAuthorizer" style="stroke: #A80036; stroke-width: 1.5;" width="156" x="474" y="312"/><ellipse cx="503.85" cy="328" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M500.2777,324.2651 L500.2777,322.1069 L507.6571,322.1069 L507.6571,324.2651 L505.1918,324.2651 L505.1918,332.3418 L507.6571,332.3418 L507.6571,334.5 L500.2777,334.5 L500.2777,332.3418 L502.7431,332.3418 L502.7431,324.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="91" x="521.15" y="332.5352">EmailAuthorizer</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="475" x2="629" y1="344" y2="344"/><ellipse cx="485" cy="355.9775" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="130" x="494" y="358.6348">memberEmailRepository</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="475" x2="629" y1="364.9551" y2="364.9551"/><ellipse cx="485" cy="376.9326" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="108" x="494" y="379.5898">createAuthNStatus()</text><ellipse cx="485" cy="389.8877" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="89" x="494" y="392.5449">verifyPassword()</text><ellipse cx="485" cy="402.8428" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="111" x="494" y="405.5">verifyEmailAddress()</text><!--class auth.Domain.CQ.api.email.command.CreateEmailAuth--><rect fill="#FEFECE" filter="url(#f6pdo735rv1w7)" height="60.9551" id="auth.Domain.CQ.api.email.command.CreateEmailAuth" style="stroke: #A80036; stroke-width: 1.5;" width="134" x="957.5" y="474.5"/><ellipse cx="975.65" cy="490.5" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M972.0777,486.7651 L972.0777,484.6069 L979.4571,484.6069 L979.4571,486.7651 L976.9918,486.7651 L976.9918,494.8418 L979.4571,494.8418 L979.4571,497 L972.0777,497 L972.0777,494.8418 L974.5431,494.8418 L974.5431,486.7651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="95" x="990.35" y="495.0352">CreateEmailAuth</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="958.5" x2="1090.5" y1="506.5" y2="506.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="958.5" x2="1090.5" y1="514.5" y2="514.5"/><ellipse cx="968.5" cy="526.4775" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="108" x="977.5" y="529.1348">createAuthNStatus()</text><!--class auth.Domain.CQ.api.email.query.GetEmailAuth--><rect fill="#FEFECE" filter="url(#f6pdo735rv1w7)" height="73.9102" id="auth.Domain.CQ.api.email.query.GetEmailAuth" style="stroke: #A80036; stroke-width: 1.5;" width="137" x="956" y="325"/><ellipse cx="983.6" cy="341" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M980.0277,337.2651 L980.0277,335.1069 L987.4071,335.1069 L987.4071,337.2651 L984.9418,337.2651 L984.9418,345.3418 L987.4071,345.3418 L987.4071,347.5 L980.0277,347.5 L980.0277,345.3418 L982.4931,345.3418 L982.4931,337.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="77" x="1000.4" y="345.5352">GetEmailAuth</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="957" x2="1092" y1="357" y2="357"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="957" x2="1092" y1="365" y2="365"/><ellipse cx="967" cy="376.9775" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="89" x="976" y="379.6348">verifyPassword()</text><ellipse cx="967" cy="389.9326" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="111" x="976" y="392.5898">verifyEmailAddress()</text><!--class auth.Domain.Repository.MemberEmailRepository--><rect fill="#FEFECE" filter="url(#f6pdo735rv1w7)" height="60.9551" id="auth.Domain.Repository.MemberEmailRepository" style="stroke: #A80036; stroke-width: 1.5;" width="473" x="788" y="102.5"/><ellipse cx="950.25" cy="118.5" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M946.6777,114.7651 L946.6777,112.6069 L954.0571,112.6069 L954.0571,114.7651 L951.5918,114.7651 L951.5918,122.8418 L954.0571,122.8418 L954.0571,125 L946.6777,125 L946.6777,122.8418 L949.1431,122.8418 L949.1431,114.7651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="140" x="970.75" y="123.0352">MemberEmailRepository</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="789" x2="1260" y1="134.5" y2="134.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="789" x2="1260" y1="142.5" y2="142.5"/><ellipse cx="799" cy="154.4775" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="447" x="808" y="157.1348">exists(emailAddress: AuthEmailAddress,rawPassword: String): OptionT[IO, Boolean]</text><!--class auth.Domain.models.AuthN--><rect fill="#FEFECE" filter="url(#f6pdo735rv1w7)" height="60.9551" id="auth.Domain.models.AuthN" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="1384" y="781.5"/><ellipse cx="1402.6" cy="797.5" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1399.0277,793.7651 L1399.0277,791.6069 L1406.4071,791.6069 L1406.4071,793.7651 L1403.9418,793.7651 L1403.9418,801.8418 L1406.4071,801.8418 L1406.4071,804 L1399.0277,804 L1399.0277,801.8418 L1401.4931,801.8418 L1401.4931,793.7651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="35" x="1417.4" y="802.0352">AuthN</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1385" x2="1458" y1="813.5" y2="813.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1385" x2="1458" y1="821.5" y2="821.5"/><ellipse cx="1395" cy="833.4775" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="49" x="1404" y="836.1348">tryAuth()</text><!--class auth.Domain.models.AuthZ--><rect fill="#FEFECE" filter="url(#f6pdo735rv1w7)" height="60.9551" id="auth.Domain.models.AuthZ" style="stroke: #A80036; stroke-width: 1.5;" width="97" x="1373" y="685.5"/><ellipse cx="1402.4" cy="701.5" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1398.8277,697.7651 L1398.8277,695.6069 L1406.2071,695.6069 L1406.2071,697.7651 L1403.7418,697.7651 L1403.7418,705.8418 L1406.2071,705.8418 L1406.2071,708 L1398.8277,708 L1398.8277,705.8418 L1401.2931,705.8418 L1401.2931,697.7651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="33" x="1419.6" y="706.0352">AuthZ</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1374" x2="1469" y1="717.5" y2="717.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="1374" x2="1469" y1="725.5" y2="725.5"/><ellipse cx="1384" cy="737.4775" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="71" x="1393" y="740.1348">verifyToken()</text><!--class auth.Domain.models.LoginContext--><rect fill="#FEFECE" filter="url(#f6pdo735rv1w7)" height="73.9102" id="auth.Domain.models.LoginContext" style="stroke: #A80036; stroke-width: 1.5;" width="164" x="942.5" y="932"/><ellipse cx="983.6" cy="948" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M986.0731,954.1431 Q985.4921,954.4419 984.8529,954.5913 Q984.2138,954.7407 983.5082,954.7407 Q981.0014,954.7407 979.6815,953.0889 Q978.3617,951.437 978.3617,948.3159 Q978.3617,945.1865 979.6815,943.5347 Q981.0014,941.8828 983.5082,941.8828 Q984.2138,941.8828 984.8612,942.0322 Q985.5087,942.1816 986.0731,942.4805 L986.0731,945.2031 Q985.4423,944.6221 984.8488,944.3523 Q984.2553,944.0825 983.6244,944.0825 Q982.2797,944.0825 981.5949,945.1492 Q980.9101,946.2158 980.9101,948.3159 Q980.9101,950.4077 981.5949,951.4744 Q982.2797,952.541 983.6244,952.541 Q984.2553,952.541 984.8488,952.2712 Q985.4423,952.0015 986.0731,951.4204 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="74" x="1003.4" y="952.5352">LoginContext</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="943.5" x2="1105.5" y1="964" y2="964"/><ellipse cx="953.5" cy="975.9775" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="110" x="962.5" y="978.6348">sessionID: SessionID</text><ellipse cx="953.5" cy="988.9326" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="138" x="962.5" y="991.5898">authNStatus: AuthNStatus</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="943.5" x2="1105.5" y1="997.9102" y2="997.9102"/><!--class auth.Domain.models.values.AccessToken--><rect fill="#FEFECE" filter="url(#f6pdo735rv1w7)" height="73.9102" id="auth.Domain.models.values.AccessToken" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="967.5" y="732"/><ellipse cx="985.65" cy="748" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M982.0777,744.2651 L982.0777,742.1069 L989.4571,742.1069 L989.4571,744.2651 L986.9918,744.2651 L986.9918,752.3418 L989.4571,752.3418 L989.4571,754.5 L982.0777,754.5 L982.0777,752.3418 L984.5431,752.3418 L984.5431,744.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="75" x="1000.35" y="752.5352">AccessToken</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="968.5" x2="1080.5" y1="764" y2="764"/><ellipse cx="978.5" cy="775.9775" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="88" x="987.5" y="778.6348">token: SessionID</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="968.5" x2="1080.5" y1="784.9551" y2="784.9551"/><ellipse cx="978.5" cy="796.9326" fill="#84BE84" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="85" x="987.5" y="799.5898">base64(): String</text><!--class auth.Domain.models.values.AuthNStatus--><rect fill="#FEFECE" filter="url(#f6pdo735rv1w7)" height="48" id="auth.Domain.models.values.AuthNStatus" style="stroke: #A80036; stroke-width: 1.5;" width="101" x="974" y="845"/><ellipse cx="989" cy="861" fill="#B4A7E5" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M985.4277,857.2651 L985.4277,855.1069 L992.8071,855.1069 L992.8071,857.2651 L990.3418,857.2651 L990.3418,865.3418 L992.8071,865.3418 L992.8071,867.5 L985.4277,867.5 L985.4277,865.3418 L987.8931,865.3418 L987.8931,857.2651 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacingAndGlyphs" textLength="69" x="1003" y="865.5352">AuthNStatus</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="975" x2="1074" y1="877" y2="877"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="975" x2="1074" y1="885" y2="885"/><!--class EmailAccessToken--><rect fill="#FEFECE" filter="url(#f6pdo735rv1w7)" height="48" id="EmailAccessToken" style="stroke: #A80036; stroke-width: 1.5;" width="138" x="483" y="745"/><ellipse cx="498" cy="761" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M500.4731,767.1431 Q499.8921,767.4419 499.2529,767.5913 Q498.6138,767.7407 497.9082,767.7407 Q495.4014,767.7407 494.0815,766.0889 Q492.7617,764.437 492.7617,761.3159 Q492.7617,758.1865 494.0815,756.5347 Q495.4014,754.8828 497.9082,754.8828 Q498.6138,754.8828 499.2612,755.0322 Q499.9087,755.1816 500.4731,755.4805 L500.4731,758.2031 Q499.8423,757.6221 499.2488,757.3523 Q498.6553,757.0825 498.0244,757.0825 Q496.6797,757.0825 495.9949,758.1492 Q495.3101,759.2158 495.3101,761.3159 Q495.3101,763.4077 495.9949,764.4744 Q496.6797,765.541 498.0244,765.541 Q498.6553,765.541 499.2488,765.2712 Q499.8423,765.0015 500.4731,764.4204 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="106" x="512" y="765.5352">EmailAccessToken</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="484" x2="620" y1="777" y2="777"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="484" x2="620" y1="785" y2="785"/><!--class EmailAuthNStatus--><rect fill="#FEFECE" filter="url(#f6pdo735rv1w7)" height="48" id="EmailAuthNStatus" style="stroke: #A80036; stroke-width: 1.5;" width="132" x="486" y="828"/><ellipse cx="501" cy="844" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M503.4731,850.1431 Q502.8921,850.4419 502.2529,850.5913 Q501.6138,850.7407 500.9082,850.7407 Q498.4014,850.7407 497.0815,849.0889 Q495.7617,847.437 495.7617,844.3159 Q495.7617,841.1865 497.0815,839.5347 Q498.4014,837.8828 500.9082,837.8828 Q501.6138,837.8828 502.2612,838.0322 Q502.9087,838.1816 503.4731,838.4805 L503.4731,841.2031 Q502.8423,840.6221 502.2488,840.3523 Q501.6553,840.0825 501.0244,840.0825 Q499.6797,840.0825 498.9949,841.1492 Q498.3101,842.2158 498.3101,844.3159 Q498.3101,846.4077 498.9949,847.4744 Q499.6797,848.541 501.0244,848.541 Q501.6553,848.541 502.2488,848.2712 Q502.8423,848.0015 503.4731,847.4204 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="100" x="515" y="848.5352">EmailAuthNStatus</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="487" x2="617" y1="860" y2="860"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="487" x2="617" y1="868" y2="868"/><!--class auth.UseCase.vchat.app.email.EmailAuth--><rect fill="#FEFECE" filter="url(#f6pdo735rv1w7)" height="73.9102" id="auth.UseCase.vchat.app.email.EmailAuth" style="stroke: #A80036; stroke-width: 1.5;" width="208" x="86" y="325"/><ellipse cx="157.25" cy="341" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M159.7231,347.1431 Q159.1421,347.4419 158.5029,347.5913 Q157.8638,347.7407 157.1582,347.7407 Q154.6514,347.7407 153.3315,346.0889 Q152.0117,344.437 152.0117,341.3159 Q152.0117,338.1865 153.3315,336.5347 Q154.6514,334.8828 157.1582,334.8828 Q157.8638,334.8828 158.5112,335.0322 Q159.1587,335.1816 159.7231,335.4805 L159.7231,338.2031 Q159.0923,337.6221 158.4988,337.3523 Q157.9053,337.0825 157.2744,337.0825 Q155.9297,337.0825 155.2449,338.1492 Q154.5601,339.2158 154.5601,341.3159 Q154.5601,343.4077 155.2449,344.4744 Q155.9297,345.541 157.2744,345.541 Q157.9053,345.541 158.4988,345.2712 Q159.0923,345.0015 159.7231,344.4204 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="57" x="177.75" y="345.5352">EmailAuth</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="87" x2="293" y1="357" y2="357"/><ellipse cx="97" cy="368.9775" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="148" x="106" y="371.6348">authorizer: EmailAuthorizer</text><ellipse cx="97" cy="381.9326" fill="none" rx="3" ry="3" style="stroke: #038048; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="182" x="106" y="384.5898">contextManager: ContextManager</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="87" x2="293" y1="390.9102" y2="390.9102"/><!--class state.Domain.models.values.SessionID--><rect fill="#FEFECE" filter="url(#f6pdo735rv1w7)" height="48" id="state.Domain.models.values.SessionID" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="509" y="1105"/><ellipse cx="524" cy="1121" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M526.4731,1127.1431 Q525.8921,1127.4419 525.2529,1127.5913 Q524.6138,1127.7407 523.9082,1127.7407 Q521.4014,1127.7407 520.0815,1126.0889 Q518.7617,1124.437 518.7617,1121.3159 Q518.7617,1118.1865 520.0815,1116.5347 Q521.4014,1114.8828 523.9082,1114.8828 Q524.6138,1114.8828 525.2612,1115.0322 Q525.9087,1115.1816 526.4731,1115.4805 L526.4731,1118.2031 Q525.8423,1117.6221 525.2488,1117.3523 Q524.6553,1117.0825 524.0244,1117.0825 Q522.6797,1117.0825 521.9949,1118.1492 Q521.3101,1119.2158 521.3101,1121.3159 Q521.3101,1123.4077 521.9949,1124.4744 Q522.6797,1125.541 524.0244,1125.541 Q524.6553,1125.541 525.2488,1125.2712 Q525.8423,1125.0015 526.4731,1124.4204 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="54" x="538" y="1125.5352">SessionID</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="510" x2="594" y1="1137" y2="1137"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="510" x2="594" y1="1145" y2="1145"/><!--link auth.Domain.CQ.api.email.EmailAuthorizer to auth.Domain.Repository.MemberEmailRepository--><path d="M630.17,324.44 C718.31,281.54 861.56,211.82 948.7,169.41 " fill="none" id="auth.Domain.CQ.api.email.EmailAuthorizer-auth.Domain.Repository.MemberEmailRepository" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="960.61,163.61,953.4647,162.6382,949.8195,168.8602,956.9648,169.8319,960.61,163.61" style="stroke: #A80036; stroke-width: 1.0;"/><!--link auth.Domain.CQ.api.email.EmailAuthorizer to auth.Domain.CQ.api.email.command.CreateEmailAuth--><path d="M630.17,385.45 C714.79,411.17 850.2,452.33 937.99,479.01 " fill="none" id="auth.Domain.CQ.api.email.EmailAuthorizer-auth.Domain.CQ.api.email.command.CreateEmailAuth" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="940.22,472.37,957.32,484.89,936.15,485.77,940.22,472.37" style="stroke: #A80036; stroke-width: 1.0;"/><!--link auth.Domain.CQ.api.email.EmailAuthorizer to auth.Domain.CQ.api.email.query.GetEmailAuth--><path d="M630.17,362 C714.04,362 847.8,362 935.65,362 " fill="none" id="auth.Domain.CQ.api.email.EmailAuthorizer-auth.Domain.CQ.api.email.query.GetEmailAuth" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="935.84,355,955.84,362,935.84,369,935.84,355" style="stroke: #A80036; stroke-width: 1.0;"/><!--link auth.Domain.models.values.AccessToken to auth.Domain.models.AuthZ--><path d="M1081.67,761.46 C1159.74,750.99 1299.66,732.21 1372.88,722.39 " fill="none" id="auth.Domain.models.values.AccessToken-auth.Domain.models.AuthZ" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#000000" points="1301,718.1553,1295,721.1553,1301,724.1553,1301,718.1553" style="stroke: #000000; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="35" x="1307" y="724.5684">verify</text><!--link auth.Domain.models.values.AccessToken to auth.Domain.models.AuthN--><path d="M1081.67,775.12 C1156.66,783.28 1288.74,797.66 1363.93,805.84 " fill="none" id="auth.Domain.models.values.AccessToken-auth.Domain.models.AuthN" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="1364.85,798.9,1383.98,808.02,1363.34,812.82,1364.85,798.9" style="stroke: #A80036; stroke-width: 1.0;"/><!--link EmailAccessToken to auth.Domain.models.values.AccessToken--><path d="M621.16,769 C707.78,769 856.87,769 947.2,769 " fill="none" id="EmailAccessToken-auth.Domain.models.values.AccessToken" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="947.46,762,967.46,769,947.46,776,947.46,762" style="stroke: #A80036; stroke-width: 1.0;"/><!--link EmailAuthNStatus to auth.Domain.models.values.AuthNStatus--><path d="M618.42,854.36 C706.64,857.55 863.09,863.2 953.57,866.47 " fill="none" id="EmailAuthNStatus-auth.Domain.models.values.AuthNStatus" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="953.98,859.48,973.72,867.2,953.48,873.47,953.98,859.48" style="stroke: #A80036; stroke-width: 1.0;"/><!--link auth.Domain.models.values.AuthNStatus to auth.Domain.models.LoginContext--><path d="M1024.5,906.46 C1024.5,915.7 1024.5,926.23 1024.5,931.84 " fill="none" id="auth.Domain.models.values.AuthNStatus-auth.Domain.models.LoginContext" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1024.5,893.22,1020.5,899.22,1024.5,905.22,1028.5,899.22,1024.5,893.22" style="stroke: #A80036; stroke-width: 1.0;"/><!--link state.Domain.models.values.SessionID to auth.Domain.models.LoginContext--><path d="M607.48,1110.47 C689.79,1082.48 846.41,1029.22 942.23,996.64 " fill="none" id="state.Domain.models.values.SessionID-auth.Domain.models.LoginContext" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="595.17,1114.66,602.1387,1116.5138,606.5302,1110.7941,599.5615,1108.9403,595.17,1114.66" style="stroke: #A80036; stroke-width: 1.0;"/><!--link auth.UseCase.vchat.app.email.EmailAuth to auth.Domain.CQ.api.email.EmailAuthorizer--><path d="M294.16,362 C346.71,362 410.01,362 460.62,362 " fill="none" id="auth.UseCase.vchat.app.email.EmailAuth-auth.Domain.CQ.api.email.EmailAuthorizer" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="473.87,362,467.87,358,461.87,362,467.87,366,473.87,362" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
skinparam linetype polyline
left to right direction

card "Domain" as auth.Domain {
  card "Command and Query" as auth.Domain.CQ {
    package "api.email" as auth.Domain.CQ.api.email {
      interface "EmailAuthorizer" as auth.Domain.CQ.api.email.EmailAuthorizer {
        +memberEmailRepository
        +createAuthNStatus()
        +verifyPassword()
        +verifyEmailAddress()
      }
      package "command" as auth.Domain.CQ.api.email.command {
        interface "CreateEmailAuth" as auth.Domain.CQ.api.email.command.CreateEmailAuth {
          +createAuthNStatus()
        }
      }
      package "query" as auth.Domain.CQ.api.email.query {
        interface "GetEmailAuth" as auth.Domain.CQ.api.email.query.GetEmailAuth {
          +verifyPassword()
          +verifyEmailAddress()
        }
      }
    }
  }

  card "Repository" as auth.Domain.Repository {
    interface "MemberEmailRepository" as auth.Domain.Repository.MemberEmailRepository {
      +exists(emailAddress: AuthEmailAddress,rawPassword: String): OptionT[IO, Boolean]
    }
  }

  card "Models" as auth.Domain.models {
    interface "AuthN" as auth.Domain.models.AuthN {
      +tryAuth()
    }
    interface "AuthZ" as auth.Domain.models.AuthZ {
      +verifyToken()
    }
    class "LoginContext" as auth.Domain.models.LoginContext {
      +sessionID: SessionID
      +authNStatus: AuthNStatus
    }
    card "values" as auth.Domain.models.values {
      interface "AccessToken" as auth.Domain.models.values.AccessToken {
        +token: SessionID
        +base64(): String
      }
      interface "AuthNStatus" as auth.Domain.models.values.AuthNStatus {
      }
      package "auth.domain.values.email" {
        class EmailAccessToken
        class EmailAuthNStatus
      }
    }
  }
}

card "UseCase" as auth.UseCase {

   package "vchat.app" as auth.UseCase.vchat.app {
     package "service.auth.email" as auth.UseCase.vchat.app.email {
       class "EmailAuth" as auth.UseCase.vchat.app.email.EmailAuth {
         +authorizer: EmailAuthorizer
         +contextManager: ContextManager
       }
     }
   }
}

auth.Domain.Repository.MemberEmailRepository *-up- auth.Domain.CQ.api.email.EmailAuthorizer
auth.Domain.CQ.api.email.command.CreateEmailAuth <|-up- auth.Domain.CQ.api.email.EmailAuthorizer
auth.Domain.CQ.api.email.query.GetEmailAuth <|-up- auth.Domain.CQ.api.email.EmailAuthorizer

auth.Domain.models.AuthZ -up- auth.Domain.models.values.AccessToken: verify >
auth.Domain.models.AuthN <|-up- auth.Domain.models.values.AccessToken
auth.Domain.models.values.AccessToken <|-up- EmailAccessToken
auth.Domain.models.values.AuthNStatus <|-up- EmailAuthNStatus

auth.Domain.models.LoginContext -right-* auth.Domain.models.values.AuthNStatus
auth.Domain.models.LoginContext -down-* state.Domain.models.values.SessionID

auth.UseCase.vchat.app.email.EmailAuth - -* auth.Domain.CQ.api.email.EmailAuthorizer
@enduml

PlantUML version 1.2019.01(Sun Feb 10 00:32:04 JST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.8+10
Operating System: Mac OS X
OS Version: 10.15.7
Default Encoding: UTF-8
Language: en
Country: JP
--></g></svg>